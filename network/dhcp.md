# DHCP（Dynamic Host Configuration Protocol，動態主機配置協定）

一種自動為設備分配IP地址的協定。

它的主要作用是**自動管理和分配網路中的IP地址**，讓網路設備可以動態地取得和釋放IP，無需手動設定。

## 1. DHCP 如何運作？

DHCP 協定的工作流程如下：

1. **DHCP Discover**(發現):

   當一台新設備（如電腦、手機）連上網路時，它會向局域網廣播一個「DHCP Discover」封包，告訴網路中的 DHCP 伺服器「我需要一個IP地址」。

2. **DHCP Offer**(提供):

   DHCP伺服器接收到這個請求後，會根據可用的IP地址範圍，提供一個IP地址，並將該IP連同子網掩碼、網關地址、DNS伺服器等設定打包成「DHCP Offer」訊息回應給設備。

3. **DHCP Request**(請求):

   設備接收到DHCP伺服器的IP地址提案後，會回應一個「DHCP Request」訊息，確認接受這個IP地址，並請求DHCP伺服器正式分配此IP。

4. **DHCP Acknowledgement**(確認):

   DHCP伺服器收到確認後，會發送「DHCP Acknowledgement」訊息，最終分配這個IP給設備。此時，設備便可以使用這個IP地址進行網路通訊。

## 2. DHCP 的 IP 位址不是固定的嗎？

DHCP分配的IP地址通常是**動態的**，並且有**租約期限**，也就是說，
每一個DHCP分配的IP地址都有一定的有效時間。當租約即將過期時，設備需要向DHCP伺服器發出請求以延長租約，否則可能會重新獲得一個新的IP地址。

#### 固定 IP vs. 動態 IP

- **動態IP**:

  DHCP分配的IP地址可以根據網路需求動態變更，適合用在大部分的用戶裝置上，如電腦、手機等。
  這樣的動態分配機制可以更有效地利用有限的IP地址資源。

- **靜態IP**:

  一些特定設備（如伺服器、打印機等）可能需要永久的固定IP地址，以便於網路上的其他設備能夠持續地訪問它們。

  在這些情況下，可以在DHCP伺服器上設置靜態IP，讓伺服器總是分配相同的IP給這些設備，或直接手動設置固定IP。

## 3. DHCP 的優點

- **自動化管理**:

  DHCP可以自動分配IP地址，減少人工配置的麻煩。

- **更有效利用IP資源**:

  透過動態分配IP，網路資源可以被更靈活地使用，特別是在用戶數量波動較大的網路環境（如公司內部網路）中。

- **簡化網路維護**:

  隨著設備變多，DHCP能自動分配並記錄IP地址，減少網路管理的負擔。

## 4. DHCP 在內網中的應用

在內網（如家庭或公司網路）中，路由器通常充當DHCP伺服器，自動為所有連接到內網的設備(如電腦、手機、智慧家居設備等) 分配IP地址。

這樣，所有設備在連接網路時，都可以自動獲得IP地址、子網掩碼、DNS等必要的網路配置，無需用戶手動設置。

## 總結

DHCP是一種協定，專門用於自動分配IP地址。

它通常為設備提供動態的IP地址，使得IP管理變得簡單靈活。

這也意味著一台設備的IP地址可能會在每次連接網路時變化，而不是固定不變的。這對於大多數用戶設備來說是有效且方便的。
