# 公有IP(Public IP) 和 私有IP(Private IP)

通常在一個家庭或公司內網中，**只有一個對外IP地址**，
這個IP地址是由ISP(網路服務提供商)分配的**公有IP**，用於在網際網路上識別這個網路的「出口」。

而內網中的設備由 DHCP 伺服器分配的IP，屬於**私有IP**，這些IP地址無法直接被外部網路訪問。

## 公有IP vs. 私有IP

- **公有IP (Public IP)**：

  這是 ISP 分配給你的路由器的IP地址，用於在網際網路上唯一識別你的網路。

  所有出入網際網路的數據流都會經過這個IP地址。

  它是對外公開的，例如你的家庭網路通常會有一個公有IP地址。

- **私有IP (Private IP)**：

  這是內網(如家庭或公司內部網路)中的設備所使用的IP地址範圍。

  私有IP 無法直接在網際網路上使用(也是一種網路安全的防護)，

  僅適用於內網(那內網如何和網際網路溝通，跟路由器、路由表、[NAT](./nat.md) 等有關)，

  並且由 [DHCP 伺服器](./dhcp.md) 自動分配給各個設備。

  常見的私有IP 範圍包括：

  - **A 類私有 IP 範圍**:

    `10.0.0.0` 到 `10.255.255.255`(共 16,777,216 個位址)

  - **B 類私有 IP 範圍**:

    `172.16.0.0` 到 `172.31.255.255`(共 1,048,576 個位址)

  - **C 類私有 IP 範圍**:

    `192.168.0.0` 到 `192.168.255.255`(共 65,536 個位址)

    大部分家庭和小型辦公室網路通常使用 C 類中的 `192.168.x.x` 範圍，
    例如 `192.168.0.x` 或 `192.168.1.x`。

  - 其他 IP 範圍，除了私有 IP 和公有 IP 外，
    還有一些特殊的 IP 範圍，例如：

    - **迴路位址(Loopback IP)**：`127.0.0.0` 到 `127.255.255.255`，常見的為 `127.0.0.1`，用於本機測試。

    - **localhost**：是一個特殊的主機名稱，指向本機的網路位址。
      通常對應於 IP 位址 `127.0.0.1`。

    - **自動私有 IP 位址(APIPA)**：`169.254.0.0` 到 `169.254.255.255`，當裝置無法取得 DHCP 服務器分配的 IP 時，會自動分配這範圍內的 IP。

    - **0.0.0.0**

      是一個特殊的非路由位址，表示「所有 IP 位址」或「未設定 IP」的概念。

      - **用途**:

        - **伺服器監聽所有 IP**:

          當伺服器設定為監聽 `0.0.0.0` 時，表示該伺服器會接受從所有網路介面(不限定某個 IP)進入的連線。

        - **網路未分配**:

          如果裝置尚未分配 IP 位址，會顯示 `0.0.0.0` 表示無法連接。

        - **路由規則**:

          在某些路由設定中，`0.0.0.0` 代表預設路由，
          表示所有未明確定義的流量路徑。

## 公有IP 和 私有IP 之間是如何與網際網路通信的？

詳情請看 [DHCP And NAT 的協作](./dhcp-and-nat.md)

## 固定IP 和 浮動IP?

- **固定 IP**:

  通常指的是一個永久不變的 IP 位址。

  `固定 IP 位址可以是公有 IP(public IP)，也可以是私有 IP(private IP)。`

  公有 IP 位址可以讓網際網路上的裝置找到並直接連接到該裝置，
  而私有 IP 則在內網中使用，不直接對外網路開放。

  固定IP是**固定的內部網路 IP(private IP)** ，例如：
  在內部網路或家庭網路中，可以為某些裝置(如伺服器、印表機)設置一個不變的內部 IP 位址，以便內部設備可以穩定地找到它。

- **浮動 IP(Dynamic IP)**:

  一般指的是隨時可能變更的 IP 位址，它通常透過 DHCP(Dynamic Host Configuration Protocol)自動分配，
  並有一個租約時間，當租約到期時會重新分配。

  浮動 IP 可以應用於內網(private IP)，
  而在部分服務提供商的配置中，也可能有浮動的公有 IP。

## 如何設置固定IP?

在內網中，你可以使用以下方法來固定或延長 IP 的租約：

- **設置靜態 IP**:

  可以直接在裝置的網路設定中，手動設置一個固定的 IP 位址。

  這種方法可以完全避免 DHCP 的租約更新，讓設備一直保持該 IP 位址。

- **DHCP 保留(DHCP Reservation)**:

  同 [DHCP Reservation](./dhcp-deservation.md)

- **延長租約時間**:

  如果無法使用靜態 IP 或 DHCP 保留，則可以在 DHCP 設定中延長租約的有效時間，讓設備在長時間內不會變更 IP 位址。

  這樣雖然不保證固定 IP，但可以減少 IP 位址變更的頻率。

## 總結

- **只有一個對外的公有IP**:

  家庭或公司網路通常只有一個公有IP，由 ISP 分配，用於網際網路通訊。

- **固定 IP 位址可以是公有 IP(public IP)，也可以是私有 IP(private IP)**
