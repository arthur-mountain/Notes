# OSI 七層模型

## **1. 第一層：物理層 (Physical Layer)**

- 物理層負責真正的數據傳輸，將數據以比特流的形式通過物理媒介傳輸。

- 網卡將數據鏈路層提供的數據轉換為物理信號，並通過網線、光纖或無線頻段傳送。

## **2. 第二層：數據連接層 (Data Link Layer)**

將數據包封裝成數據幀，調用網卡的硬體接口，發送數據

- 這一層負責將網路層數據封裝為幀並在同一網段內傳輸，包含 MAC 位址、錯誤檢查等機制。

- 內核會通過網卡驅動程式將數據包封裝成數據幀，並調用網卡的硬體接口來發送數據。

- 當數據經過數據鏈路層處理後，內核會將數據送到網卡，由網卡將數據轉換成電信號或無線信號。

## **3. 第三層：網路層 (Network Layer)**

- 網路層的主要功能是選擇路徑和尋址，並將數據包路由到目標 IP 位址。IPv4、IPv6 等協定運行在這一層。

- 內核負責處理 IP 封包的路由選擇、地址解析(如 ARP)、分片與重組等工作。

## **4. 第四層：傳輸層 (Transport Layer)**

傳輸層是網路通信中確保數據在發送方和接收方之間**可靠傳輸**的核心層。

主要功能包括**數據分段、流量控制、錯誤檢測**。它使用兩種主要協定：

- **TCP (傳輸控制協定)**:

  - 提供可靠的數據傳輸。

  - 通過 **三次握手** 建立連接，確保數據完整到達接收方。

  - 適用於需要高可靠性的應用，如網頁瀏覽 (HTTP/HTTPS)、電子郵件 (SMTP)、檔案傳輸 (FTP) 等。

- **UDP (使用者數據報協定)**:

  - 提供非可靠的數據傳輸。

  - 不建立連接、無重傳機制，但速度更快。

  - 適用於實時應用，如視訊通話、在線遊戲等。

## **5. 第五層：會話層 (Session Layer)**

**建立、管理和結束通信會話**，提供會話恢復和管理的功能，
確保數據傳輸過程中的同步和持續性。

- **主要功能**:

  - 保持通信期間的數據同步。

  - 在通信中斷後支持會話恢復。

  - 為應用層提供會話管理。

- **現代應用**:

  - 許多會話層功能已整合到應用層協定中。

  - 例如：遠端桌面協定 (RDP)、點對點通信協定等，利用會話層的概念管理通信連接。

- 補充 **Keep-Alive 的實現**:

  - TCP 協定內建的 Keep-Alive 機制可以保持長時間連接，
    例如 HTTP 協定的 `Connection: keep-alive` 標頭，
    避免每次請求都重新建立連接。

  - 雖然 Keep-Alive 的功能與會話層的概念相關，
    但實際上由 TCP 層提供技術支持。

## **6. 第六層：表示層 (Presentation Layer)**

表示層負責**數據格式轉換、加密與壓縮**，確保數據在不同系統間正確傳輸和解釋。

- **數據格式轉換**:

  - 處理不同系統的格式差異，如:

    - Big Endian 與 Little Endian。

    - 音視頻格式轉換(如 MP4 → AVI)。

  - 確保發送方和接收方的數據格式一致，例如文字編碼(UTF-8 → ASCII)。

  - **兼容性支持**: 保證接收方能正確解析和還原數據。

- **加密與壓縮**:

  - 實現數據安全性和壓縮效率，例如 SSL/TLS 加密(儘管其多數功能現在位於應用層)。

表示層是數據在應用層與傳輸層之間的重要橋樑。

## **OSI 與 TCP/IP 模型的整合**

實際網路中，許多協定(如 TCP/IP)並未完全遵循 OSI 模型，會話層和表示層的功能通常被合併或簡化：

- **TCP/IP 模型的應用層**：

  - 結合了 OSI 模型的應用層、會話層和表示層功能，直接由應用程式實現。

- **傳輸層**：

  - 在 TCP/IP 和 OSI 模型中概念一致，負責通信管理。

## **小結**

- **第四層 (傳輸層)**:

  - 確保數據可靠傳輸，使用 TCP/UDP 協定。

- **第五層 (會話層)**:

  - 管理通信會話，支持數據同步和恢復。

  - 現代網路中多數功能整合到應用層協定中。

- **第六層 (表示層)**:

  - 負責數據的格式轉換、加密和壓縮。

  - 現代網路中的 SSL/TLS 加密功能隸屬於表示層。

- **第三層到第七層**:

  大部分操作在內核中完成，特別是傳輸層和網路層，內核負責處理協議細節、路由選擇和數據包管理。

- **第二層和第一層**:

  當數據進入數據鏈路層和物理層時，才通過網卡真正發送到網路上。

  因此，只有到了數據鏈路層和物理層，數據才真正轉變為電信號或無線信號傳輸，這是唯一「真實在網路上傳輸」的部分。

- OSI 模型中的每一層有其明確的功能，
  但在現代網路協定(如 TCP/IP 模型)中，
  會話層和表示層的功能大多被應用層或應用程式實現，
  傳輸層的功能則保持一致性。
