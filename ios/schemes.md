# Schemes

用於定義專案在不同情境下的建置、執行、測試和部署方式。

## 什麼是 Scheme？

Scheme 是 Xcode 中的一組設定，決定了專案在各種操作（如建置、執行、測試等）時的行為。

它包含了建置配置、執行參數、測試計劃等，讓開發者能夠針對不同需求，快速切換專案的運行方式。

## Scheme 的主要功能

### 建置配置

Scheme 指定了專案在建置時應使用的配置。

例如：常見的配置有 **Debug** 和 **Release**。

開發者也可以自定義新的建置配置，以適應特定需求。

### 執行參數

透過 Scheme，可以設定應用程式在執行時的行為，包括：

- **環境變數**：設定應用程式啟動時的環境參數。

- **啟動引數**：傳遞給應用程式的命令列引數。

- **調試設定**：設定調試器的行為，如是否中斷在特定位置。

### 測試計劃

Scheme 支援設定自動化測試的相關配置，包括：

- **測試目標**：指定要執行的測試套件。

- **測試配置**：設定測試執行時的環境和參數。

- **代碼覆蓋率**：啟用或禁用代碼覆蓋率分析。

### 分析與歸檔

Scheme 也控制著專案在分析（Analyze）和歸檔（Archive）時的行為，這對於發現潛在的代碼問題和準備應用程式發布至關重要。

## 為什麼要使用 Scheme？

### 環境管理

在開發過程中，常常需要針對不同的運行環境進行配置，例如開發、測試、預發布和生產環境。

透過為每個環境建立專屬的 Scheme，可以：

- 快速切換環境而不需手動更改設定。

- 確保每個環境的配置一致，減少錯誤。

### 提高開發效率

Scheme 允許預先設定常用的建置和執行參數，避免每次執行前手動調整，節省時間。

### 支援自動化流程

在持續整合（CI）和持續部署（CD）中，Scheme 可以用於自動化建置和測試流程，確保應用程式的一致性和品質。

## 如何管理 Scheme

### 查看與選擇 Scheme

在 Xcode 專案名稱旁邊的下拉選單列出了所有可用的 Scheme。

點擊該選單即可查看並選擇當前要使用的 Scheme。

### 編輯 Scheme

1. **開啟編輯器**：在 Scheme 選單中，選擇 **Edit Scheme...**。

2. **配置動作**：左側列表顯示了可配置的動作，如 **Build**、**Run**、**Test**、**Profile**、**Analyze** 和 **Archive**。

3. **調整設定**：選擇一個動作後，可以在右側設定相應的參數，例如建置配置、執行參數、環境變數等。

### 新建或複製 Scheme

- **新建 Scheme**：

  1. 在 Scheme 選單中，選擇 **New Scheme...**。

  2. 為新的 Scheme 命名，並進行初始設定。

- **複製 Scheme**：

  1. 在 Scheme 選單中，選擇 **Manage Schemes...**。

  2. 選擇要複製的 Scheme，點擊齒輪圖標，選擇 **Duplicate Scheme**。

  3. 為複製的 Scheme 命名，並根據需要修改設定。

### 共享 Scheme

默認情況下，Scheme 是本地的私人設定。如果需要與團隊成員共享 Scheme，請：

1. 在 **Manage Schemes...** 中，勾選要共享的 Scheme 的 **Shared** 欄位。

2. 確保共享的 Scheme 檔案被納入版控。

## 實際應用

### 針對不同環境建立 Scheme

為了管理多個運行環境，可以為每個環境創建一個專屬的 Scheme。例如：

- **Development Scheme**：連接開發伺服器，啟用調試模式。

- **Staging Scheme**：連接測試伺服器，用於內部測試。

- **Production Scheme**：連接生產伺服器，關閉調試資訊。

### 自定義執行參數與環境變數

在不同的 Scheme 中，可以設定特定的執行參數和環境變數，以控制應用程式的行為。

- **設定方式**：

  1. 編輯 Scheme，選擇 **Run** 動作。

  2. 切換到 **Arguments** 標籤。

  3. 在 **Arguments Passed On Launch** 中添加啟動引數。

  4. 在 **Environment Variables** 中添加環境變數。

- **應用場景**：

  - 啟用或禁用某些功能旗標。

  - 模擬特定的運行環境或狀態。

### 測試自動化

利用 Scheme，可以設定自動化測試的流程，確保在每次建置時都進行完整的測試。

- **配置步驟**：

  1. 編輯 Scheme，選擇 **Test** 動作。

  2. 添加或移除測試目標。

  3. 配置測試執行的順序和選項。

## 最佳實踐

### 命名規範

- **清晰明瞭**：Scheme 的名稱應該清楚反映其用途或所對應的環境，例如 `AppName-Dev`、`AppName-Staging`、`AppName-Prod`。

- **一致性**：在團隊中統一命名規範，方便協作和管理。

### 版本控制

- **共享設定**：將需要共享的 Scheme 設置為 Shared，並納入版本控制。

- **避免衝突**：定期同步並更新 Scheme，防止團隊成員之間的設定衝突。

### 定期檢查與維護

- **更新設定**：隨著專案的發展，及時更新 Scheme 的設定以符合新的需求。

- **清理無用的 Scheme**：刪除不再使用的 Scheme，保持專案的整潔。

## 參考資料

- [Apple Developer Documentation - Schemes](https://developer.apple.com/documentation/xcode/customizing-the-build-schemes-for-a-project)
