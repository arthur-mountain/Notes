# File Descriptors(文件描述符)

在 Unix/Linux 系統中，程式執行時會使用三個預設的文件描述符（File Descriptors）：

- **標準輸入（stdin）**：編號 `0`，預設從鍵盤或輸入檔案讀取資料。

- **標準輸出（stdout）**：編號 `1`，預設將正常輸出顯示在終端機上。

- **標準錯誤（stderr）**：編號 `2`，預設將錯誤訊息顯示在終端機上。

ㄤ`/dev/null` 是一個特殊的裝置檔案，任何寫入其中的資料都會被丟棄，相當於「黑洞」。

---

## **1. `> /dev/null`**

### **說明**

- **語法**：`command > /dev/null`

- **功能**：將 **標準輸出（stdout）** 重定向到 `/dev/null`，也就是說，指令的正常輸出會被丟棄，不會顯示在終端機上。

### **等價寫法**

- `command 1> /dev/null`

  - `1` 代表標準輸出（stdout），明確指定重定向的文件描述符。

### **範例**

```bash
ls > /dev/null
```

- 執行 `ls` 命令，但不會顯示目錄列表。

### **應用情境**

- **當您不需要看到正常輸出，但希望保留錯誤訊息時，可以使用此重定向方式。**

---

## **2. `> /dev/null 2>&1`**

### **說明**

- **語法解析**：

  - `> /dev/null`：將 **標準輸出（stdout）** 重定向到 `/dev/null`。

  - `2>&1`：將 **標準錯誤（stderr）** 重定向到 **標準輸出（stdout）**。

### **效果**

- **標準輸出**：被丟棄（寫入 `/dev/null`）。

- **標準錯誤**：被重定向到 **標準輸出**，但因為標準輸出已經指向 `/dev/null`，所以錯誤訊息也被丟棄。

### **範例**

```bash
command > /dev/null 2>&1
```

- 執行 `command`，同時丟棄正常輸出和錯誤訊息。

---

## **重定向語法總結**

- **`>` 或 `1>`**：重定向 **標準輸出（stdout）**。

  - 例如：`command > file.txt` 將標準輸出寫入 `file.txt`。

- **`2>`**：重定向 **標準錯誤（stderr）**。

  - 例如：`command 2> error.log` 將錯誤訊息寫入 `error.log`。

- **`&>`**：同時重定向 **標準輸出** 和 **標準錯誤**（某些 Shell 支援，如 Bash）。

  - 例如：`command &> all.log`。

- **`n>&m`**：將文件描述符 `n` 重定向到文件描述符 `m`。

  - 例如：`2>&1` 將標準錯誤重定向到標準輸出。

---

## **應用範例**

### **僅丟棄標準輸出，保留錯誤訊息**

```bash
command > /dev/null
```

- 使用情境：執行命令時不需要看到正常輸出，但希望看到錯誤訊息以便除錯。

### **僅丟棄錯誤訊息，保留標準輸出**

```bash
command 2> /dev/null
```

- 使用情境：只想看到正常輸出，不想被錯誤訊息干擾。

### **同時丟棄標準輸出和錯誤訊息**

```bash
command > /dev/null 2>&1
```

- 使用情境：執行命令時不需要任何輸出，常用於計時或測試腳本。

### **將錯誤訊息重定向到標準輸出（一起顯示）**

```bash
command 2>&1 | tee output.log
```

- 使用情境：希望將所有輸出（正常和錯誤）一起記錄或處理。

---

## **深入理解**

### **文件描述符重定向順序**

- **重定向操作的順序很重要**。在 `command > /dev/null 2>&1` 中：

  1. `> /dev/null`：首先，標準輸出被重定向到 `/dev/null`。

  2. `2>&1`：接著，將標準錯誤重定向到現在的標準輸出位置（即 `/dev/null`）。

- **如果順序顛倒，效果會不同**：

  ```bash
  command 2>&1 > /dev/null
  ```

  1. `2>&1`：首先，將標準錯誤重定向到標準輸出（終端機）。

  2. `> /dev/null`：接著，標準輸出被重定向到 `/dev/null`。

  - **結果**：標準輸出被丟棄，但錯誤訊息仍然顯示在終端機上。

---

## **結論**

- **`> /dev/null`**

  - **功能**：丟棄標準輸出，保留錯誤訊息。

- **`> /dev/null 2>&1`**

  - **功能**：同時丟棄標準輸出和錯誤訊息。

- **重定向時需要注意語法和順序**，以確保達到預期的效果。

## **參考資料**

[man bash](https://www.gnu.org/software/bash/manual/bash.html)
